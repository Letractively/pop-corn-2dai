<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:faces="http://www.springframework.org/schema/faces"
	xsi:schemaLocation="http://www.springframework.org/schema/webflow
        http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd"
	parent="parent-flow">

    
    <input name="quedada" />
    <input name="rol"/>


    <on-start>
        <evaluate expression="fechasController.getFechas(quedada)" result="flowScope.fechas" />
    </on-start>

    <view-state id="votarQuedada" view="quedadaVotacion.xhtml">

        <on-render>            
            <evaluate expression="votoController.getPreferencias(quedada)" result="requestScope.preferencias" />
        </on-render>
        
        <transition on="votarQuedada" to="resumenVotacion">
            <evaluate expression="votoController.votarQuedada(flowRequestContext)" />            
        </transition>


        <transition on="borrarVoto" >
            <evaluate expression="votoController.borrarVoto(flowRequestContext)" />
        </transition>
        
        <transition on="resumenVotacion" to="resumenVotacion"/>


    </view-state>

    <view-state id="resumenVotacion" view="quedadaResumenVotacion.xhtml">
        <on-render>
            <evaluate expression="votoController.getPreferencias(quedada)" result="requestScope.preferencias" />
            <evaluate expression="votoController.getResumenVotos(fechas)" result="requestScope.listasResumenVotos" />
        </on-render>
    </view-state>



    

</flow>
